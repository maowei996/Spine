{"version":3,"sources":["file:///Users/weimao/XiaYu/VScodeProject/CocosCreate/spine/assets/src/Machine.ts"],"names":["_decorator","Component","Node","assetManager","Texture2D","sp","Sprite","FileTools","Html5","ccclass","property","Machine","_spineJson","_spineAtlas","_spineTexture","start","onTest","console","log","spr","HtmlFileInput","file","LoadImage","texture","loadJson","getInstance","readLocalFile","data","loadAtlas","loadRemoto","base","loadRemote","err","asset","cc","error","image","spriteFrame","addSpine","spineNode","name","setPosition","skeleton","addComponent","Skeleton","find","addChild","SkeletonData","skeletonJson","atlasText","textures","textureNames","skeletonData","animation"],"mappings":"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","sourcesContent":["\n\nimport { _decorator, Component, Node,assetManager,Texture2D,SpriteFrame,ImageAsset,sp } from 'cc';\nimport FileTools from './FileTools';\nimport { Html5 } from './Html5';\n\nimport {Sprite} from 'cc'\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('Machine')\nexport class Machine extends Component {\n\n  @property(Sprite)\n  sp: Sprite = null!;\n\n\n  _spineJson :any = null;\n\n  _spineAtlas : any = null;\n\n  _spineTexture: any = null;\n\n\n  start() {\n    \n  }\n\n\n\n\n\n\n  onTest() :void {\n    console.log('==========点击测试按钮！！');\n\n    let spr = this.sp;\n\n\n    /***/\n    Html5.HtmlFileInput(function( file : any ){\n\n      console.log('===========选择文件成功-data:',file);\n\n      Html5.LoadImage(file,spr, function( texture: Texture2D ){\n\n       this._spineTexture = texture;\n\n\n      });\n\n\n    });\n  }\n\n\n  loadJson() {\n    Html5.HtmlFileInput(function( file : any ){\n\n      FileTools.getInstance().readLocalFile(file,1,function( data : any ){\n        console.log('===========读取Json成功-data:',data);\n        this._spineJson = data\n      });\n\n    });\n  }\n\n  loadAtlas() {\n    Html5.HtmlFileInput(function( file : any ){\n\n      FileTools.getInstance().readLocalFile(file,1,function( data : any ){\n        console.log('===========读取Atlas成功-data:',data);\n        \n        this._spineAtlas = data\n\n      });\n\n    });\n  }\n\n  loadRemoto () {\n    //const base = url;\n    //assetManager.loadRemote(base, { ext: '.png' }, (err: Error, texture: Texture2D) => {\n\n    let sp = this.sp;\n    let base = 'http://127.0.0.1/image/Socre_CandyMonsters_Scatter.png';\n    assetManager.loadRemote(base, (err, asset: ImageAsset) => {\n      if (err) return cc.error(err);\n      console.log('asset:',asset)\n\n      let texture = new Texture2D();\n      texture.image = asset;\n\n      // sp.spriteFrame = new SpriteFrame();\n      // sp.spriteFrame.setTexture(texture)\n      // sp.spriteFrame._texture = texture\n      // sp.spriteFrame._texture = texture.getHtmlElementObj()\n      sp.spriteFrame.texture = texture\n    })\n  }\n\n\n\n  private addSpine () {\n    let spineNode = new Node();\n    spineNode.name = 'newSpine';\n    spineNode.setPosition(0,0);\n    var skeleton = spineNode.addComponent(sp.Skeleton);\n\n    // skeleton.parent = this.node;\n    cc.find(\"Canvas\").addChild(spineNode);\n\n    let asset = new sp.SkeletonData();\n    asset.skeletonJson = this._spineJson;\n    asset.atlasText = this._spineAtlas;\n    asset.textures = [this._spineTexture];\n    asset.textureNames = ['xxx1122.png'];\n\n\n    skeleton.skeletonData = asset;\n    skeleton.animation = 'walk';\n    //skeleton._updateSkeletonData();\n\n\n  }\n}\n\n\n\n"]}